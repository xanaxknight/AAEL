{%- comment -%}
  Hero Card Snippet
  Renders a hero card with viewport-adaptive height, responsive aspect ratios, and per-slide alignment.
  
  Usage in sections:
  Pass section.blocks to this snippet and it will render each block as a slide.
  
  Parameters:
  - blocks: Array of slide blocks (required)
  - timings: Comma-separated durations in ms for each slide (default: '12000')
  - max_width: Maximum width for the card (optional)
{%- endcomment -%}

{%- liquid
  assign slide_timings = timings | default: '12000'
  assign card_max_width = max_width | default: ''
  assign slide_blocks = blocks
-%}

<hero-card 
  data-timings="[{{ slide_timings }}]"
  {%- if card_max_width != blank -%}
    style="max-width: {{ card_max_width }}px;"
  {%- endif -%}
>
  <div class="hero-visual">
    {%- if slide_blocks.size > 0 -%}
      {%- for block in slide_blocks -%}
        {%- liquid
          assign h_align = block.settings.align_horizontal | default: 'center'
          assign v_align = block.settings.align_vertical | default: 'center'
          assign alignment_class = 'align-' | append: h_align | append: '-' | append: v_align
        -%}
        
        <div class="slide-container{% if forloop.first %} active{% endif %}" {{ block.shopify_attributes }}>
          {%- liquid
            if forloop.first
              assign loading_priority = 'eager'
            else
              assign loading_priority = 'lazy'
            endif
          -%}
          
          {%- comment -%} Light theme image {%- endcomment -%}
          {%- if block.settings.image_light -%}
            {{- block.settings.image_light | image_url: width: 3840 | image_tag:
              class: 'hero-image img-light ' | append: alignment_class,
              loading: loading_priority,
              widths: '750, 1100, 1500, 1920, 2560, 3840',
              sizes: '100vw',
              alt: block.settings.alt_text | default: 'Hero image'
            -}}
          {%- elsif block.settings.image_light_url != blank -%}
            <img 
              src="{{ block.settings.image_light_url }}" 
              alt="{{ block.settings.alt_text | default: 'Hero image' }}"
              class="hero-image img-light {{ alignment_class }}"
              loading="{{ loading_priority }}"
              draggable="false"
            >
          {%- endif -%}
          
          {%- comment -%} Dark theme image {%- endcomment -%}
          {%- if block.settings.image_dark -%}
            {{- block.settings.image_dark | image_url: width: 3840 | image_tag:
              class: 'hero-image img-dark ' | append: alignment_class,
              loading: loading_priority,
              widths: '750, 1100, 1500, 1920, 2560, 3840',
              sizes: '100vw',
              alt: block.settings.alt_text | default: 'Hero image'
            -}}
          {%- elsif block.settings.image_dark_url != blank -%}
            <img 
              src="{{ block.settings.image_dark_url }}" 
              alt="{{ block.settings.alt_text | default: 'Hero image' }}"
              class="hero-image img-dark {{ alignment_class }}"
              loading="{{ loading_priority }}"
              draggable="false"
            >
          {%- endif -%}
        </div>
      {%- endfor -%}
    {%- else -%}
      {%- comment -%} Placeholder if no slides {%- endcomment -%}
      <div class="slide-container active">
        <div class="product-image-placeholder">
          {{ 'lifestyle-1' | placeholder_svg_tag: 'hero-image' }}
        </div>
      </div>
    {%- endif -%}
  </div>
  
  {%- comment -%} Card Controls {%- endcomment -%}
  {%- assign slide_count = slide_blocks.size | default: 1 -%}
  {%- if slide_count > 1 -%}
    <div class="card-controls">
      {%- comment -%} Theme Toggle {%- endcomment -%}
      <button type="button" class="slider-theme-toggle js-theme-toggle-slider" aria-label="Toggle theme">
        <span class="theme-icon theme-icon--light" aria-hidden="true">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M7.73438 1.625C7.50521 1.625 7.3125 1.54688 7.15625 1.39062C7 1.22917 6.92188 1.03646 6.92188 0.8125C6.92188 0.588542 7 0.398438 7.15625 0.242188C7.3125 0.0807292 7.50521 0 7.73438 0C7.95833 0 8.14844 0.0807292 8.30469 0.242188C8.46615 0.398438 8.54688 0.588542 8.54688 0.8125C8.54688 1.03646 8.46615 1.22917 8.30469 1.39062C8.14844 1.54688 7.95833 1.625 7.73438 1.625ZM12.6328 3.64844C12.4036 3.64844 12.2109 3.57031 12.0547 3.41406C11.8984 3.2526 11.8203 3.0599 11.8203 2.83594C11.8203 2.61198 11.8984 2.42188 12.0547 2.26562C12.2109 2.10417 12.4036 2.02344 12.6328 2.02344C12.8568 2.02344 13.0469 2.10417 13.2031 2.26562C13.3594 2.42188 13.4375 2.61198 13.4375 2.83594C13.4375 3.0599 13.3594 3.2526 13.2031 3.41406C13.0469 3.57031 12.8568 3.64844 12.6328 3.64844ZM14.6562 8.54688C14.4271 8.54688 14.2344 8.46875 14.0781 8.3125C13.9219 8.15104 13.8438 7.95833 13.8438 7.73438C13.8438 7.51042 13.9219 7.32031 14.0781 7.16406C14.2344 7.0026 14.4271 6.92188 14.6562 6.92188C14.8802 6.92188 15.0703 7.0026 15.2266 7.16406C15.3828 7.32031 15.4609 7.51042 15.4609 7.73438C15.4609 7.95833 15.3828 8.15104 15.2266 8.3125C15.0703 8.46875 14.8802 8.54688 14.6562 8.54688ZM12.6328 13.4453C12.4036 13.4453 12.2109 13.3672 12.0547 13.2109C11.8984 13.0495 11.8203 12.8568 11.8203 12.6328C11.8203 12.4089 11.8984 12.2188 12.0547 12.0625C12.2109 11.901 12.4036 11.8203 12.6328 11.8203C12.8568 11.8203 13.0469 11.901 13.2031 12.0625C13.3594 12.2188 13.4375 12.4089 13.4375 12.6328C13.4375 12.8568 13.3594 13.0495 13.2031 13.2109C13.0469 13.3672 12.8568 13.4453 12.6328 13.4453ZM7.73438 15.4688C7.50521 15.4688 7.3125 15.388 7.15625 15.2266C7 15.0703 6.92188 14.8802 6.92188 14.6562C6.92188 14.4323 7 14.2396 7.15625 14.0781C7.3125 13.9219 7.50521 13.8438 7.73438 13.8438C7.95833 13.8438 8.14844 13.9219 8.30469 14.0781C8.46615 14.2396 8.54688 14.4323 8.54688 14.6562C8.54688 14.8802 8.46615 15.0703 8.30469 15.2266C8.14844 15.388 7.95833 15.4688 7.73438 15.4688ZM2.83594 13.4453C2.61198 13.4453 2.41927 13.3672 2.25781 13.2109C2.10156 13.0495 2.02344 12.8568 2.02344 12.6328C2.02344 12.4089 2.10156 12.2188 2.25781 12.0625C2.41927 11.901 2.61198 11.8203 2.83594 11.8203C3.0599 11.8203 3.25 11.901 3.40625 12.0625C3.56771 12.2188 3.64844 12.4089 3.64844 12.6328C3.64844 12.8568 3.56771 13.0495 3.40625 13.2109C3.25 13.3672 3.0599 13.4453 2.83594 13.4453ZM0.8125 8.54688C0.588542 8.54688 0.395833 8.46875 0.234375 8.3125C0.078125 8.15104 0 7.95833 0 7.73438C0 7.51042 0.078125 7.32031 0.234375 7.16406C0.395833 7.0026 0.588542 6.92188 0.8125 6.92188C1.03646 6.92188 1.22656 7.0026 1.38281 7.16406C1.54427 7.32031 1.625 7.51042 1.625 7.73438C1.625 7.95833 1.54427 8.15104 1.38281 8.3125C1.22656 8.46875 1.03646 8.54688 0.8125 8.54688ZM2.83594 3.64844C2.61198 3.64844 2.41927 3.57031 2.25781 3.41406C2.10156 3.2526 2.02344 3.0599 2.02344 2.83594C2.02344 2.61198 2.10156 2.42188 2.25781 2.26562C2.41927 2.10417 2.61198 2.02344 2.83594 2.02344C3.0599 2.02344 3.25 2.10417 3.40625 2.26562C3.56771 2.42188 3.64844 2.61198 3.64844 2.83594C3.64844 3.0599 3.56771 3.2526 3.40625 3.41406C3.25 3.57031 3.0599 3.64844 2.83594 3.64844ZM7.73438 11.7109C7.18229 11.7109 6.66667 11.6094 6.1875 11.4062C5.70833 11.1979 5.28646 10.9115 4.92188 10.5469C4.55729 10.1823 4.27083 9.76042 4.0625 9.28125C3.85417 8.79688 3.75 8.28125 3.75 7.73438C3.75 7.18229 3.85417 6.66667 4.0625 6.1875C4.27083 5.70833 4.55729 5.28646 4.92188 4.92188C5.28646 4.55729 5.70833 4.27083 6.1875 4.0625C6.66667 3.85417 7.18229 3.75 7.73438 3.75C8.28125 3.75 8.79427 3.85417 9.27344 4.0625C9.75781 4.27083 10.1823 4.55729 10.5469 4.92188C10.9115 5.28646 11.1953 5.70833 11.3984 6.1875C11.6068 6.66667 11.7109 7.18229 11.7109 7.73438C11.7109 8.28125 11.6068 8.79688 11.3984 9.28125C11.1953 9.76042 10.9115 10.1823 10.5469 10.5469C10.1823 10.9115 9.75781 11.1979 9.27344 11.4062C8.79427 11.6094 8.28125 11.7109 7.73438 11.7109Z" fill="currentColor"/>
          </svg>
        </span>
        <span class="theme-icon theme-icon--dark" aria-hidden="true">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M12.0859 10.4844C12.5651 10.4844 13.0208 10.4427 13.4531 10.3594C13.8854 10.2708 14.2526 10.1771 14.5547 10.0781C14.6276 10.0521 14.6875 10.0339 14.7344 10.0234C14.7865 10.013 14.8385 10.0078 14.8906 10.0078C15 10.0078 15.1016 10.0521 15.1953 10.1406C15.2943 10.2292 15.3438 10.3464 15.3438 10.4922C15.3438 10.5286 15.3359 10.5911 15.3203 10.6797C15.3099 10.763 15.2891 10.8516 15.2578 10.9453C14.9245 11.7891 14.4062 12.5573 13.7031 13.25C13.0052 13.9375 12.1719 14.487 11.2031 14.8984C10.2396 15.3099 9.19792 15.5156 8.07812 15.5156C6.96354 15.5156 5.91667 15.3047 4.9375 14.8828C3.96354 14.4661 3.10677 13.888 2.36719 13.1484C1.6276 12.4089 1.04688 11.5521 0.625 10.5781C0.208333 9.59896 0 8.55208 0 7.4375C0 6.38021 0.200521 5.36458 0.601562 4.39062C1.00781 3.41146 1.57031 2.54688 2.28906 1.79688C3.01302 1.04167 3.85417 0.471354 4.8125 0.0859375C4.90104 0.0494792 4.98698 0.0260417 5.07031 0.015625C5.15885 0.00520833 5.22396 0 5.26562 0C5.42188 0 5.53906 0.046875 5.61719 0.140625C5.69531 0.234375 5.73438 0.333333 5.73438 0.4375C5.73438 0.473958 5.72917 0.523438 5.71875 0.585938C5.70833 0.643229 5.6849 0.716146 5.64844 0.804688C5.55469 1.01823 5.47135 1.28385 5.39844 1.60156C5.32552 1.91406 5.26562 2.24479 5.21875 2.59375C5.17708 2.94271 5.15625 3.27865 5.15625 3.60156C5.15625 4.66406 5.31771 5.61979 5.64062 6.46875C5.96354 7.3125 6.42708 8.03385 7.03125 8.63281C7.64062 9.23177 8.36979 9.6901 9.21875 10.0078C10.0729 10.3255 11.0286 10.4844 12.0859 10.4844Z" fill="currentColor"/>
          </svg>
        </span>
      </button>
      
      {%- comment -%} Dot Navigation {%- endcomment -%}
      <div class="dotnav-container" role="tablist">
        {%- for i in (1..slide_count) -%}
          <button class="dotnav-item{% if forloop.first %} active{% endif %}" type="button" role="tab" data-index="{{ forloop.index0 }}">
            <div class="dot-progress"></div>
          </button>
        {%- endfor -%}
      </div>
      
      {%- comment -%} Play/Pause Button {%- endcomment -%}
      <button class="control-btn" type="button" aria-label="Pause slideshow">
        <svg width="10" height="12" viewBox="0 0 10 12" fill="currentColor" class="icon-pause">
          <rect width="3.5" height="12" rx="1.75" /><rect x="6.5" width="3.5" height="12" rx="1.75" />
        </svg>
        <svg width="10" height="12" viewBox="0 0 10 12" fill="currentColor" class="icon-play u-hidden" style="transform: translateX(2px);">
          <path d="M9.359 5.25391C9.88281 5.58984 9.88281 6.36328 9.359 6.69922L1.47461 11.7246C0.919922 12.0781 0.189453 11.6816 0.189453 11.0117V0.941406C0.189453 0.271484 0.919922 -0.125 1.47461 0.228516L9.359 5.25391Z" />
        </svg>
      </button>
    </div>
  {%- endif -%}
</hero-card>
