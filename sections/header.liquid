{%- liquid
  assign collection_text = section.settings.collection_text | default: 'C24'
  assign show_bag = section.settings.show_bag
  assign right_button_text = section.settings.right_button_text
  assign right_button_link = section.settings.right_button_link
-%}

<div class="grid-container">
  {%- comment -%} Logo & Collection Block {%- endcomment -%}
  <div 
    class="grid-block header-block"
    style="
      --span-s: span 1;
      --start-s: 1;
      --row-s: 1;
      --align-s: flex-start;
      --text-s: left;
      --span-m: span 1;
      --start-m: 1;
      --row-m: 1;
      --align-m: flex-start;
      --text-m: left;
      --span-l: span 1;
      --start-l: 2;
      --row-l: 1;
      --align-l: flex-start;
      --text-l: left;
      --span-xl: span 1;
      --start-xl: 3;
      --row-xl: 1;
      --align-xl: flex-start;
      --text-xl: left;
    "
  >
    <div class="logo-badge" style="justify-content: space-between; width: 100%; padding: 0 24px;">
      <a href="{{ routes.root_url }}" class="brand-logo-link" aria-label="{{ shop.name }}">
        {%- if section.settings.logo != blank -%}
          {{ section.settings.logo | image_url: width: 300 | image_tag:
            class: 'header__heading-logo',
            widths: '50, 100, 150, 200, 250, 300',
            height: section.settings.logo_width,
            width: section.settings.logo.width,
            alt: shop.name
          }}
        {%- else -%}
          <h1 class="brand-text" style="letter-spacing: 0.45rem;">{{ section.settings.logo_text | default: shop.name }}</h1>
        {%- endif -%}
      </a>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" class="logo-mark">
        <path d="M12.001 0C18.629 0 24.0019 5.373 24.002 12.001C24.0018 18.6289 18.629 24.002 12.001 24.002C5.37309 24.0018 0.00011442 18.6289 0 12.001C9.89583e-05 5.37308 5.37308 0.000116675 12.001 0ZM12.1807 12.4268L7.07324 21.2734C8.54297 22.0561 10.2196 22.5019 12.001 22.502C15.7329 22.502 19.0077 20.5535 20.8701 17.6201L17.8721 12.4268H12.1807ZM6.12695 12.4268L3.13184 17.6201C3.8369 18.7306 4.74325 19.7 5.80176 20.4756L10.4482 12.4268H6.12695ZM1.51074 12.4268C1.56176 13.7053 1.84013 14.9247 2.30859 16.0459L4.39551 12.4268H1.51074ZM19.6045 12.4268L21.6934 16.0449C22.1616 14.924 22.4402 13.705 22.4912 12.4268H19.6045ZM10.6455 1.58887C5.83677 2.20882 2.04724 6.07923 1.55469 10.9268H5.26074L10.6455 1.58887ZM6.99219 10.9268H11.3145L14.1602 5.99805L11.9971 2.25L6.99219 10.9268ZM13.0469 10.9268H17.0059L15.0264 7.49805L13.0469 10.9268ZM15.8926 5.99805L18.7383 10.9268H22.4482C22.1126 7.62342 20.2442 4.77482 17.5674 3.09766L15.8926 5.99805ZM15.0264 4.49805L16.2412 2.39355C15.3361 1.9935 14.3645 1.71812 13.3467 1.58789L15.0264 4.49805Z" fill="currentColor"/>
      </svg>
      <span class="collection-text">{{ collection_text }}</span>
    </div>
  </div>

  {%- comment -%} Theme Toggle Block {%- endcomment -%}
  <div 
    class="grid-block header-block desktop-only"
    style="
      --span-s: span 0;
      --start-s: auto;
      --row-s: 1;
      --span-m: span 2;
      --start-m: 2;
      --row-m: 1;
      --align-m: center;
      --text-m: center;
      --span-l: span 2;
      --start-l: 3;
      --row-l: 1;
      --align-l: center;
      --text-l: center;
      --span-xl: span 2;
      --start-xl: 4;
      --row-xl: 1;
      --align-xl: center;
      --text-xl: center;
    "
  >
    <button 
      class="icon-btn js-theme-toggle" 
      type="button"
      aria-label="{{ 'general.theme.toggle' | t | default: 'Toggle theme' }}"
    >
      {% render 'icon-theme' %}
    </button>
  </div>

  {%- comment -%} Right Action Block (CTA) {%- endcomment -%}
  <div 
    class="grid-block header-block"
    style="
      --span-s: span 1;
      --start-s: 2;
      --row-s: 1;
      --align-s: center;
      --text-s: right;
      --span-m: span 1;
      --start-m: 4;
      --row-m: 1;
      --align-m: center;
      --text-m: right;
      --span-l: span 1;
      --start-l: 5;
      --row-l: 1;
      --align-l: center;
      --text-l: right;
      --span-xl: span 1;
      --start-xl: 6;
      --row-xl: 1;
      --align-xl: center;
      --text-xl: right;
    "
  >
    <div class="bag-container" style="padding: 0 24px;">
      {%- if right_button_text != blank and right_button_link != blank -%}
        <a href="{{ right_button_link }}" class="pill-btn">
          {{ right_button_text }}
        </a>
      {%- elsif show_bag -%}
        <a href="{{ routes.cart_url }}" class="bag-btn" aria-label="{{ 'cart.title' | t }}">
          BAG (<span class="cart-count">{{ cart.item_count }}</span>)
        </a>
      {%- endif -%}
    </div>
  </div>
</div>

{%- comment -%} Mobile Menu Toggle - Absolute Centered {%- endcomment -%}
<div class="mobile-menu-absolute mobile-only">
  <button 
    class="icon-btn js-menu-toggle" 
    type="button"
    aria-label="{{ 'general.menu.open' | t | default: 'Open menu' }}"
    aria-expanded="false"
    aria-controls="MobileMenu"
  >
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="menu-toggle-icon">
      <line x1="0" y1="2" x2="24" y2="2" class="menu-line menu-line-1" />
      <line x1="0" y1="7" x2="24" y2="7" class="menu-line menu-line-2" />
      <line x1="0" y1="12" x2="24" y2="12" class="menu-line menu-line-3" />
      <line x1="0" y1="17" x2="24" y2="17" class="menu-line menu-line-4" />
      <line x1="0" y1="22" x2="24" y2="22" class="menu-line menu-line-5" />
    </svg>
  </button>
</div>

{% schema %}
{
  "name": "Header",
  "class": "section-header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 50,
      "max": 250,
      "step": 10,
      "default": 100,
      "unit": "px",
      "label": "Custom logo width"
    },
    {
      "type": "text",
      "id": "logo_text",
      "label": "Logo text (fallback)",
      "default": "AAEL"
    },
    {
      "type": "text",
      "id": "collection_text",
      "label": "Logo suffix (C24)",
      "info": "Part of the full logo: AAEL [graphic] C24",
      "default": "C24"
    },
    {
      "type": "checkbox",
      "id": "show_bag",
      "label": "Show cart bag",
      "default": true
    },
    {
      "type": "header",
      "content": "Custom right button"
    },
    {
      "type": "text",
      "id": "right_button_text",
      "label": "Button text",
      "info": "Leave blank to show cart bag instead"
    },
    {
      "type": "url",
      "id": "right_button_link",
      "label": "Button link"
    }
  ]
}
{% endschema %}
