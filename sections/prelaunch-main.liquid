{%- liquid
  assign hero_text = section.settings.hero_text | default: 'AAEL creates limited series of interior artifacts primarily out of metal.'
  assign newsletter_title = section.settings.newsletter_title | default: 'Let me know when AMO is available'
  assign newsletter_placeholder = section.settings.newsletter_placeholder | default: 'Email'
  assign newsletter_button = section.settings.newsletter_button | default: 'Send'
  assign product = section.settings.product
  assign slide_timings = section.settings.slide_timings | default: '12000,6000'
  assign collection_text = section.settings.collection_text | default: 'C24'
-%}

<div class="prelaunch-container">
  {%- comment -%} Prelaunch Header {%- endcomment -%}
  <div class="prelaunch-header">
    <div class="grid-container">
      {%- comment -%} Logo Block {%- endcomment -%}
      <div 
        class="grid-block header-block"
        style="
          --span-s: span 1;
          --start-s: auto;
          --row-s: 1;
          --align-s: center;
          --text-s: center;
          --span-m: span 1;
          --start-m: auto;
          --row-m: 1;
          --align-m: flex-start;
          --text-m: left;
          --span-l: span 1;
          --start-l: 2;
          --row-l: 1;
          --align-l: flex-start;
          --text-l: left;
          --span-xl: span 1;
          --start-xl: 3;
          --row-xl: 1;
          --align-xl: flex-start;
          --text-xl: left;
        "
      >
        <div class="logo-badge">
          <a href="{{ routes.root_url }}" class="brand-logo-link" aria-label="{{ shop.name }}">
            {%- if section.settings.logo != blank -%}
              {%- assign logo_alt = section.settings.logo.alt | default: shop.name | escape -%}
              {{ section.settings.logo | image_url: width: 300 | image_tag:
                class: 'header__heading-logo',
                widths: '50, 100, 150, 200, 250, 300',
                height: section.settings.logo_width,
                width: section.settings.logo.width,
                alt: logo_alt
              }}
            {%- else -%}
              <h1 class="brand-text">{{ section.settings.logo_text | default: 'AAEL' }}</h1>
            {%- endif -%}
          </a>
          
          {%- if collection_text != blank -%}
            <span class="collection-text">{{ collection_text }}</span>
          {%- endif -%}
        </div>
      </div>

      {%- comment -%} Theme Toggle - Desktop Only {%- endcomment -%}
      <div 
        class="grid-block header-block desktop-only"
        style="
          --span-s: span 0;
          --start-s: auto;
          --row-s: 1;
          --align-s: center;
          --text-s: center;
          --span-m: span 2;
          --start-m: auto;
          --row-m: 1;
          --align-m: center;
          --text-m: center;
          --span-l: span 2;
          --start-l: 3;
          --row-l: 1;
          --align-l: center;
          --text-l: center;
          --span-xl: span 2;
          --start-xl: 4;
          --row-xl: 1;
          --align-xl: center;
          --text-xl: center;
        "
      >
        <button 
          class="icon-btn js-theme-toggle" 
          type="button"
          aria-label="{{ 'general.theme.toggle' | t | default: 'Toggle theme' }}"
        >
          {% render 'icon-theme' %}
        </button>
      </div>

      {%- comment -%} CTA Button {%- endcomment -%}
      <div 
        class="grid-block header-block"
        style="
          --span-s: span 1;
          --start-s: auto;
          --row-s: 1;
          --align-s: center;
          --text-s: center;
          --span-m: span 1;
          --start-m: 4;
          --row-m: 1;
          --align-m: flex-end;
          --text-m: right;
          --span-l: span 1;
          --start-l: 5;
          --row-l: 1;
          --align-l: center;
          --text-l: center;
          --span-xl: span 1;
          --start-xl: 6;
          --row-xl: 1;
          --align-xl: center;
          --text-xl: center;
        "
      >
        <div class="bag-container">
          <a href="#newsletter-form" class="pill-btn js-scroll-to-newsletter">
            {{ section.settings.cta_button_text | default: 'Let me know' }}
          </a>
        </div>
      </div>
    </div>
  </div>

  {%- comment -%} Content {%- endcomment -%}
  <div class="grid-container prelaunch-content">
    {%- comment -%} Hero Text {%- endcomment -%}
    <div 
      class="grid-block prelaunch-hero"
      style="
        --span-s: span 2;
        --start-s: auto;
        --align-s: center;
        --text-s: center;
        --span-m: span 4;
        --align-m: center;
        --text-m: center;
        --span-l: span 6;
        --align-l: center;
        --text-l: center;
        --span-xl: span 8;
        --align-xl: center;
        --text-xl: center;
      "
    >
      <h2 class="lead-text" style="max-width: 800px; margin: 0 auto;">
        {{ hero_text }}
      </h2>
    </div>
    
    {%- comment -%} Product Card - Prelaunch Variant {%- endcomment -%}
    <div 
      class="grid-block prelaunch-card-block"
      style="
        --span-s: span 2;
        --start-s: auto;
        --align-s: center;
        --text-s: center;
        --span-m: span 4;
        --align-m: center;
        --text-m: center;
        --span-l: span 6;
        --align-l: center;
        --text-l: center;
        --span-xl: span 8;
        --align-xl: center;
        --text-xl: center;
      "
    >
      {%- if product != blank -%}
        {% render 'product-card', 
          product: product, 
          variant: 'prelaunch',
          timings: slide_timings,
          max_width: '1440px'
        %}
      {%- else -%}
        {%- comment -%} Fallback with external images for demo {%- endcomment -%}
        <product-card 
          class="product-card prelaunch"
          data-timings="[{{ slide_timings }}]"
          style="max-width: 1440px;"
        >
          <div class="product-visual">
            {%- for block in section.blocks -%}
              {%- if block.type == 'slide' -%}
                <div class="slide-container{% if forloop.first %} active{% endif %}">
                  {%- if block.settings.image_light -%}
                    {{- block.settings.image_light | image_url: width: 1440 | image_tag:
                      class: 'product-image img-light',
                      loading: 'lazy',
                      widths: '375, 550, 750, 1100, 1440',
                      sizes: '(min-width: 1440px) 1440px, 100vw',
                      alt: block.settings.alt_text | default: 'Product image'
                    -}}
                  {%- elsif block.settings.image_light_url != blank -%}
                    <img 
                      src="{{ block.settings.image_light_url }}" 
                      alt="{{ block.settings.alt_text | default: 'Product image' }}"
                      class="product-image img-light"
                      loading="lazy"
                      draggable="false"
                      style="object-position: center;"
                    >
                  {%- endif -%}
                  
                  {%- if block.settings.image_dark -%}
                    {{- block.settings.image_dark | image_url: width: 1440 | image_tag:
                      class: 'product-image img-dark',
                      loading: 'lazy',
                      widths: '375, 550, 750, 1100, 1440',
                      sizes: '(min-width: 1440px) 1440px, 100vw',
                      alt: block.settings.alt_text | default: 'Product image'
                    -}}
                  {%- elsif block.settings.image_dark_url != blank -%}
                    <img 
                      src="{{ block.settings.image_dark_url }}" 
                      alt="{{ block.settings.alt_text | default: 'Product image' }}"
                      class="product-image img-dark"
                      loading="lazy"
                      draggable="false"
                      style="object-position: center;"
                    >
                  {%- endif -%}
                </div>
              {%- endif -%}
            {%- endfor -%}
          </div>
          
          {%- comment -%} Card Controls {%- endcomment -%}
          {%- assign slide_count = 0 -%}
          {%- for block in section.blocks -%}
            {%- if block.type == 'slide' -%}
              {%- assign slide_count = slide_count | plus: 1 -%}
            {%- endif -%}
          {%- endfor -%}
          
          {%- if slide_count > 1 -%}
            <div class="card-controls">
              <button 
                class="control-btn" 
                type="button"
                aria-label="{{ 'products.card.pause' | t | default: 'Pause slideshow' }}"
              >
                <svg width="10" height="12" viewBox="0 0 10 12" fill="currentColor" class="icon-pause">
                  <rect width="3.5" height="12" rx="1.75" />
                  <rect x="6.5" width="3.5" height="12" rx="1.75" />
                </svg>
                <svg width="10" height="12" viewBox="0 0 10 12" fill="currentColor" class="icon-play u-hidden" style="transform: translateX(2px);">
                  <path d="M9.359 5.25391C9.88281 5.58984 9.88281 6.36328 9.359 6.69922L1.47461 11.7246C0.919922 12.0781 0.189453 11.6816 0.189453 11.0117V0.941406C0.189453 0.271484 0.919922 -0.125 1.47461 0.228516L9.359 5.25391Z" />
                </svg>
              </button>
              
              <div class="dotnav-container" role="tablist" aria-label="{{ 'products.card.slides' | t | default: 'Product slides' }}">
                {%- for i in (1..slide_count) -%}
                  {%- assign index = forloop.index0 -%}
                  <button 
                    class="dotnav-item{% if forloop.first %} active{% endif %}"
                    type="button"
                    role="tab"
                    aria-selected="{% if forloop.first %}true{% else %}false{% endif %}"
                    aria-label="{{ 'products.card.slide' | t: index: forloop.index | default: 'Slide' | append: ' ' | append: forloop.index }}"
                    data-index="{{ index }}"
                  >
                    <div class="dot-progress"></div>
                  </button>
                {%- endfor -%}
              </div>
            </div>
          {%- endif -%}
        </product-card>
      {%- endif -%}
    </div>

    {%- comment -%} Newsletter Form {%- endcomment -%}
    <div 
      class="grid-block prelaunch-newsletter-block"
      style="
        --span-s: span 2;
        --start-s: auto;
        --align-s: center;
        --text-s: center;
        --span-m: span 4;
        --align-m: center;
        --text-m: center;
        --span-l: span 6;
        --align-l: center;
        --text-l: center;
        --span-xl: span 8;
        --align-xl: center;
        --text-xl: center;
      "
    >
      <div id="newsletter-form" class="newsletter-wrapper" style="width: 100%; max-width: 400px; margin: 0 auto; text-align: center;">
        <h2 class="lead-text" style="margin-bottom: 32px;">
          {{ newsletter_title }}
        </h2>
        
        {%- form 'customer', class: 'newsletter-form-prelaunch' -%}
          <input type="hidden" name="contact[tags]" value="newsletter,prelaunch">
          
          <div class="newsletter-input-group" style="display: flex; width: 100%; gap: 8px; align-items: center;">
            <input 
              type="email" 
              name="contact[email]"
              id="NewsletterEmail"
              class="newsletter-input-prelaunch"
              placeholder="{{ newsletter_placeholder }}"
              autocomplete="email"
              autocapitalize="off"
              autocorrect="off"
              required
              aria-label="{{ newsletter_placeholder }}"
            >
            <button 
              type="submit"
              class="pill-btn newsletter-submit-btn"
            >
              {{ newsletter_button }}
            </button>
          </div>
          
          {%- if form.errors -%}
            <div class="newsletter-error" style="margin-top: 12px; color: #ff4444;">
              {{ form.errors.messages['email'] }}
            </div>
          {%- endif -%}
          
          {%- if form.posted_successfully? -%}
            <div class="newsletter-success" style="margin-top: 12px;">
              {{ 'newsletter.success' | t | default: 'Thanks for subscribing!' }}
            </div>
          {%- endif -%}
        {%- endform -%}
      </div>
    </div>
  </div>
  
  {%- comment -%} Sticky Footer {%- endcomment -%}
  <div class="grid-container" style="margin-top: auto;">
    {%- comment -%} Logo Block {%- endcomment -%}
    <div 
      class="grid-block footer-block"
      style="
        --span-s: span 1;
        --start-s: auto;
        --align-s: center;
        --text-s: center;
        --span-m: span 1;
        --align-m: center;
        --text-m: center;
        --span-l: span 1;
        --start-l: 2;
        --align-l: flex-start;
        --text-l: left;
        --span-xl: span 1;
        --start-xl: 3;
        --align-xl: flex-start;
        --text-xl: left;
      "
    >
      <div class="logo-badge">
        <a href="{{ routes.root_url }}" class="brand-logo-link" aria-label="{{ shop.name }}">
          {%- if section.settings.logo != blank -%}
            {{ section.settings.logo | image_url: width: 300 | image_tag:
              class: 'header__heading-logo',
              widths: '50, 100, 150, 200, 250, 300',
              height: section.settings.logo_width,
              width: section.settings.logo.width,
              alt: shop.name
            }}
          {%- else -%}
            <span class="brand-text">{{ section.settings.logo_text | default: 'AAEL' }}</span>
          {%- endif -%}
        </a>
        <span class="collection-text">{{ collection_text }}</span>
      </div>
    </div>

    {%- comment -%} Footer Links - Desktop Only {%- endcomment -%}
    {%- for block in section.blocks -%}
      {%- if block.type == 'footer_link' -%}
        <div 
          class="grid-block footer-block desktop-only"
          style="
            --span-m: span 1;
            --align-m: center;
            --text-m: center;
            --span-l: span 1;
            --align-l: center;
            --text-l: center;
          "
          {{ block.shopify_attributes }}
        >
          <a 
            href="{{ block.settings.link }}" 
            class="footer-text"
            {%- if block.settings.open_new_tab -%}
              target="_blank" 
              rel="noopener noreferrer"
            {%- endif -%}
          >
            {{ block.settings.label }}
          </a>
        </div>
      {%- endif -%}
    {%- endfor -%}

    {%- comment -%} Copyright {%- endcomment -%}
    <div 
      class="grid-block footer-block"
      style="
        --span-s: span 1;
        --start-s: auto;
        --align-s: center;
        --text-s: center;
        --span-m: span 1;
        --align-m: center;
        --text-m: center;
        --span-l: span 1;
        --start-l: 5;
        --align-l: center;
        --text-l: center;
        --span-xl: span 1;
        --start-xl: 6;
        --align-xl: center;
        --text-xl: center;
      "
    >
      <span class="footer-text static-text">Â©{{ 'now' | date: '%Y' }}</span>
    </div>
  </div>
</div>

<style>
  .newsletter-input-prelaunch {
    flex-grow: 1;
    padding: 12px 16px;
    border-radius: 12px;
    border: none;
    background-color: var(--bg);
    color: var(--fg);
    font-family: var(--font-main);
    font-size: 16px;
    height: 42px;
    outline: none;
    transition: background-color 1200ms ease, color 1200ms ease;
  }
  
  body.dark .newsletter-input-prelaunch {
    background-color: #333;
  }
  
  .newsletter-input-prelaunch::placeholder {
    color: var(--fg);
    opacity: 0.5;
  }
</style>

{% schema %}
{
  "name": "Prelaunch Main",
  "class": "section-prelaunch-main",
  "tag": "section",
  "settings": [
    {
      "type": "header",
      "content": "Brand"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo image"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 50,
      "max": 250,
      "step": 10,
      "default": 100,
      "unit": "px",
      "label": "Custom logo width"
    },
    {
      "type": "text",
      "id": "logo_text",
      "label": "Logo text (fallback)",
      "default": "AAEL"
    },
    {
      "type": "text",
      "id": "collection_text",
      "label": "Collection text",
      "default": "C24"
    },
    {
      "type": "text",
      "id": "cta_button_text",
      "label": "CTA button text",
      "default": "Let me know"
    },
    {
      "type": "header",
      "content": "Hero"
    },
    {
      "type": "textarea",
      "id": "hero_text",
      "label": "Hero text",
      "default": "AAEL creates limited series of interior artifacts primarily out of metal."
    },
    {
      "type": "header",
      "content": "Product"
    },
    {
      "type": "product",
      "id": "product",
      "label": "Featured product"
    },
    {
      "type": "text",
      "id": "slide_timings",
      "label": "Slide timings (ms)",
      "default": "12000,6000",
      "info": "Comma-separated duration for each slide in milliseconds"
    },
    {
      "type": "header",
      "content": "Newsletter"
    },
    {
      "type": "text",
      "id": "newsletter_title",
      "label": "Newsletter title",
      "default": "Let me know when AMO is available"
    },
    {
      "type": "text",
      "id": "newsletter_placeholder",
      "label": "Email placeholder",
      "default": "Email"
    },
    {
      "type": "text",
      "id": "newsletter_button",
      "label": "Submit button text",
      "default": "Send"
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Product slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "image_light",
          "label": "Image (light mode)"
        },
        {
          "type": "image_picker",
          "id": "image_dark",
          "label": "Image (dark mode)"
        },
        {
          "type": "url",
          "id": "image_light_url",
          "label": "Image URL (light mode)",
          "info": "Use if not using image picker"
        },
        {
          "type": "url",
          "id": "image_dark_url",
          "label": "Image URL (dark mode)",
          "info": "Use if not using image picker"
        },
        {
          "type": "text",
          "id": "alt_text",
          "label": "Alt text"
        }
      ]
    },
    {
      "type": "footer_link",
      "name": "Footer link",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "About"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        },
        {
          "type": "checkbox",
          "id": "open_new_tab",
          "label": "Open in new tab",
          "default": false
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Prelaunch Main",
      "blocks": [
        {
          "type": "slide",
          "settings": {
            "image_light_url": "https://i.ibb.co/YFqGLMGM/amo-5-d.webp",
            "image_dark_url": "https://i.ibb.co/x8CZ1cNY/amo-5-n.webp",
            "alt_text": "AMO Desk Lamp"
          }
        },
        {
          "type": "slide",
          "settings": {
            "image_light_url": "https://i.ibb.co/M5N8XTHW/amo-4-d.webp",
            "image_dark_url": "https://i.ibb.co/PGdjc1mn/amo-4-n.webp",
            "alt_text": "AMO Desk Lamp"
          }
        },
        {
          "type": "slide",
          "settings": {
            "image_light_url": "https://i.ibb.co/VWjW5STB/d-v3.webp",
            "image_dark_url": "https://i.ibb.co/fmHHdcb/n-v3.webp",
            "alt_text": "AMO Desk Lamp"
          }
        },
        {
          "type": "footer_link",
          "settings": {
            "label": "ABOUT",
            "link": "/pages/about"
          }
        },
        {
          "type": "footer_link",
          "settings": {
            "label": "INSTA",
            "link": "https://instagram.com",
            "open_new_tab": true
          }
        }
      ]
    }
  ]
}
{% endschema %}
