{%- liquid
  assign padding_top = section.settings.padding_top | default: 80
  assign padding_bottom = section.settings.padding_bottom | default: 120
  assign max_width = section.settings.max_width | default: 800
-%}

<div class="about-content-wrapper" style="padding-top: {{ padding_top }}px; padding-bottom: {{ padding_bottom }}px;">
  <div class="grid-container">
    <div 
      class="grid-block"
      style="
        --span-s: span 2;
        --align-s: center;
        --text-s: center;
        --span-m: span 4;
        --align-m: center;
        --text-m: center;
        --span-l: span 6;
        --align-l: center;
        --text-l: center;
        --span-xl: span 6;
        --start-xl: 2;
        --align-xl: center;
        --text-xl: center;
      "
    >
      <div class="about-content-inner" style="max-width: {{ max_width }}px; margin: 0 auto; padding: 0 24px;">
        
        <p class="about-paragraph" style="text-align: center; font-family: 'Helvetica Now Display', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 64px; font-style: normal; font-weight: 400; line-height: normal; letter-spacing: 0.08rem; margin-bottom: 1.5em;">
          AAEL creates authored objects and spatial elements for interior spaces.
        </p>

        <p class="about-paragraph" style="text-align: center; font-family: 'Helvetica Now Display', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 64px; font-style: normal; font-weight: 400; line-height: normal; letter-spacing: 0.08rem; margin-bottom: 1.5em;">
          The project unfolds in stages, with distinct series released as limited drops. Honest materials guide the practice and keep decisions clear. None comes first: form, function, and structure take shape together.
        </p>

        <p class="about-paragraph" style="text-align: center; font-family: 'Helvetica Now Display', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 64px; font-style: normal; font-weight: 400; line-height: normal; letter-spacing: 0.08rem; margin-bottom: 1.5em;">
          Made as anchors within a room, these objects hold a quiet presence, open to subtle change.
        </p>

        <div class="about-contact" style="margin-top: 60px;">
          <button 
            class="email-copy-btn" 
            data-email="hi@aael24.com"
            aria-label="Copy email address to clipboard"
            type="button"
          >
            <span class="email-text">hi@aael24.com</span>
            <div class="email-tooltip">
              <span class="tooltip-default-text">Click to copy</span>
              <span class="tooltip-mobile-text">Tap to copy</span>
              <span class="tooltip-success-text">Copied</span>
            </div>
          </button>
        </div>

      </div>
    </div>
  </div>
</div>

<style>
  /* Email Copy Button - Styled like bag-btn */
  .email-copy-btn {
    display: inline-flex;
    position: relative;
    height: auto;
    padding: 0;
    background: transparent;
    border: none;
    color: var(--fg);
    font-family: var(--font-main);
    font-size: 1.5rem;
    font-weight: 500;
    line-height: 1;
    letter-spacing: 0.075rem;
    text-transform: uppercase;
    cursor: pointer;
    white-space: nowrap;
  }

  /* Email text with smooth opacity transition - force lowercase */
  .email-text {
    font-size: 24px;
    transition: opacity 0.3s ease;
    text-transform: lowercase;
  }

  .email-copy-btn:hover .email-text {
    opacity: 0.6;
  }

  /* Tooltip - absolutely positioned below button */
  .email-tooltip {
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(-5px);
    margin-top: 12px;
    padding: 0;
    background: transparent;
    color: #B9B9B9;
    font-family: "Neue Haas Grotesk Display Pro", "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 0.75rem;
    font-weight: 500;
    line-height: 1.125rem;
    letter-spacing: 0.0375rem;
    text-transform: none;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease, transform 0.3s ease, color 0.3s ease;
    z-index: 1000;
  }

  /* Show default text by default, hide success and mobile text */
  .tooltip-success-text,
  .tooltip-mobile-text {
    display: none;
  }

  /* Hover state - show tooltip with slide up animation */
  .email-copy-btn:hover .email-tooltip {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }

  .email-copy-btn:hover .tooltip-default-text {
    display: inline;
  }

  /* Success state - green text, no background, hide hover text */
  .email-copy-btn.copied .email-tooltip {
    opacity: 1 !important;
    transform: translateX(-50%) translateY(0) !important;
    background: transparent;
    color: #84D278;
  }

  /* When in success state, prevent showing hover text */
  .email-copy-btn.copied:hover .tooltip-default-text,
  .email-copy-btn.copied:hover .tooltip-mobile-text {
    display: none !important;
  }

  .email-copy-btn.copied:hover .tooltip-success-text {
    display: inline !important;
  }

  .email-copy-btn.copied .tooltip-default-text,
  .email-copy-btn.copied .tooltip-mobile-text {
    display: none !important;
  }

  .email-copy-btn.copied .tooltip-success-text {
    display: inline !important;
  }

  /* Dissolve animation */
  .email-copy-btn.dissolving .email-tooltip {
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  /* Keep email at full opacity when copied */
  .email-copy-btn.copied .email-text,
  .email-copy-btn.copied:hover .email-text {
    opacity: 1;
  }

  /* Responsive adjustments - Mobile gets visible tooltip */
  @media (max-width: 768px) {
    .about-paragraph {
      font-size: 32px !important;
      letter-spacing: 0.04rem !important;
    }
    
    .email-copy-btn {
      font-size: 1.2rem !important;
    }

    .email-tooltip {
      font-size: 0.65rem !important;
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* Hide desktop text, show mobile text on mobile */
    .tooltip-default-text {
      display: none !important;
    }

    .tooltip-mobile-text {
      display: inline !important;
    }

    /* Keep hover behavior disabled on mobile */
    .email-copy-btn:hover .email-text {
      opacity: 1;
    }
  }

  @media (max-width: 480px) {
    .about-paragraph {
      font-size: 32px !important;
      letter-spacing: 0.03rem !important;
    }

    .email-copy-btn {
      font-size: 1rem !important;
    }

    .email-tooltip {
      font-size: 0.6rem !important;
    }
  }
</style>

<script>
  (function() {
    'use strict';
    
    // Wait for DOM to be ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initEmailCopy);
    } else {
      initEmailCopy();
    }
    
    function initEmailCopy() {
      const emailBtn = document.querySelector('.email-copy-btn');
      
      if (!emailBtn) return;
      
      let dissolveTimeout = null;
      let resetTimeout = null;
      
      // Click handler - copy and show success
      emailBtn.addEventListener('click', function(e) {
        e.preventDefault();
        
        // Clear any existing timeouts
        if (dissolveTimeout) clearTimeout(dissolveTimeout);
        if (resetTimeout) clearTimeout(resetTimeout);
        
        const email = this.getAttribute('data-email');
        
        // Try modern clipboard API first
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(email).then(function() {
            showCopiedState(emailBtn);
          }).catch(function(err) {
            // Fallback for clipboard API failure
            fallbackCopy(email, emailBtn);
          });
        } else {
          // Fallback for older browsers
          fallbackCopy(email, emailBtn);
        }
      });
      
      // Mouse leave handler - hide tooltip if not in copied state
      emailBtn.addEventListener('mouseleave', function() {
        if (!this.classList.contains('copied')) {
          // Tooltip will hide automatically via CSS :hover
        }
      });
    }
    
    function showCopiedState(btn) {
      // Remove any existing states
      btn.classList.remove('dissolving');
      
      // Add copied state immediately
      btn.classList.add('copied');
      
      // After 2 seconds, start dissolve animation
      const dissolveTimeout = setTimeout(function() {
        btn.classList.add('dissolving');
        
        // After dissolve animation completes (300ms), remove all classes
        const resetTimeout = setTimeout(function() {
          btn.classList.remove('copied', 'dissolving');
        }, 300);
      }, 2000);
    }
    
    function fallbackCopy(text, btn) {
      // Create temporary textarea
      const textarea = document.createElement('textarea');
      textarea.value = text;
      textarea.style.position = 'fixed';
      textarea.style.opacity = '0';
      textarea.style.pointerEvents = 'none';
      document.body.appendChild(textarea);
      
      try {
        textarea.select();
        textarea.setSelectionRange(0, 99999); // For mobile devices
        
        const successful = document.execCommand('copy');
        
        if (successful) {
          showCopiedState(btn);
        }
      } catch (err) {
        console.error('Failed to copy email:', err);
      } finally {
        document.body.removeChild(textarea);
      }
    }
  })();
</script>

{% schema %}
{
  "name": "About Content",
  "tag": "section",
  "class": "section-about-content",
  "settings": [
    {
      "type": "range",
      "id": "max_width",
      "min": 600,
      "max": 1000,
      "step": 50,
      "default": 800,
      "unit": "px",
      "label": "Content max width"
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 200,
      "step": 8,
      "default": 80,
      "unit": "px",
      "label": "Padding Top"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 200,
      "step": 8,
      "default": 120,
      "unit": "px",
      "label": "Padding Bottom"
    }
  ],
  "presets": [
    {
      "name": "About Content"
    }
  ]
}
{% endschema %}
